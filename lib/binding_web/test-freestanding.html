<!DOCTYPE html>
<html>
<head>
    <title>Tree-sitter Freestanding WASM Test</title>
</head>
<body>
    <h1>Tree-sitter Freestanding WASM Test</h1>
    <div id="output"></div>
    
    <script type="module">
        import createModule from './lib/wasm-loader.js';
        
        async function test() {
            const output = document.getElementById('output');
            
            try {
                output.innerHTML += '<p>Loading freestanding WASM...</p>';
                
                // Load our freestanding Tree-sitter WASM
                const Module = await createModule();
                
                output.innerHTML += '<p>‚úÖ WASM loaded successfully!</p>';
                output.innerHTML += `<p>Memory size: ${Module.HEAPU8.length} bytes</p>`;
                
                // Test basic initialization
                if (Module.ts_init) {
                    const result = Module.ts_init();
                    output.innerHTML += `<p>‚úÖ ts_init() returned: ${result}</p>`;
                } else {
                    output.innerHTML += '<p>‚ùå ts_init not found</p>';
                }
                
                // Test a simple function
                if (Module.ts_parser_new_wasm) {
                    output.innerHTML += '<p>‚úÖ ts_parser_new_wasm found</p>';
                } else {
                    output.innerHTML += '<p>‚ùå ts_parser_new_wasm not found</p>';
                }
                
                output.innerHTML += '<p><strong>üéâ Freestanding Tree-sitter WASM is working!</strong></p>';
                
            } catch (error) {
                output.innerHTML += `<p>‚ùå Error: ${error.message}</p>`;
                console.error(error);
            }
        }
        
        test();
    </script>
</body>
</html>
